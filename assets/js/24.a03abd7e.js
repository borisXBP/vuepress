(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{560:function(t,a,n){"use strict";n.r(a);var s=n(2),r=Object(s.a)({},(function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"angular"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#angular"}},[t._v("#")]),t._v(" Angular")]),t._v(" "),n("p",[t._v("作为“为大型前端项目”而设计的前端框架，Angular 其实有许多值得参考和学习的设计，本系列主要用于研究这些设计和功能的实现原理。本文围绕 Angular 的核心功能 Ivy 编译器，介绍其中变更检测的过程。")]),t._v(" "),n("p",[t._v("介绍 Ivy 编译器中使用了增量 DOM 的设计。在 Ivy 中，通过编译器将模板编译为"),n("code",[t._v("template")]),t._v("渲染函数，该过程会将对模板的解析编译成增量 DOM 相关的指令。其中，在"),n("code",[t._v("elementStart()")]),t._v("执行时，我们可以看到会通过"),n("code",[t._v("createElementNode()")]),t._v("方法来创建 DOM。")]),t._v(" "),n("p",[t._v("而增量 DOM 中的变更检测、Diff 和更新 DOM 等能力，都与"),n("code",[t._v("elementStart()")]),t._v("方法紧紧关联着。")]),t._v(" "),n("p",[t._v("默认情况下，所有异步操作都在 Angular Zone 内。该逻辑在创建 Angular 应用的时候便已添加，这会自动触发变更检测：")]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("@"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Injectable")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ApplicationRef")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("constructor")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token parameter"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("_zone")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" NgZone"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("_injector")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Injector"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("_exceptionHandler")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" ErrorHandler"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("_componentFactoryResolver")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" ComponentFactoryResolver"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("_initStatus")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" ApplicationInitStatus")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_onMicrotaskEmptySubscription "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_zone"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("onMicrotaskEmpty"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("subscribe")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("next")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_zone"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("run")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("tick")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br")])]),n("h3",{attrs:{id:"低热度的-angular"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#低热度的-angular"}},[t._v("#")]),t._v(" "),n("a",{attrs:{href:"http://www.godbasin.com/angular/deep-into-angular/angular-design-0-prestart.html#%E4%BD%8E%E7%83%AD%E5%BA%A6%E7%9A%84-angular",target:"_blank",rel:"noopener noreferrer"}},[t._v("#"),n("OutboundLink")],1),t._v(" 低热度的 Angular")]),t._v(" "),n("p",[t._v("作为三大前端框架之一，Angular 在国内的热度实在是低。个人认为原因包括：")]),t._v(" "),n("ul",[n("li",[t._v("AngularJS 到 Angular2 的断崖式升级，失去了很多开发者的信任")]),t._v(" "),n("li",[t._v("Angular 除了依赖注入（Provider/Service）、指令/管道等功能设计，在断崖升级时引入的 Typescript/Decorator/模块化组织/AOT/JIT 等新的能力，对当时大多数前端开发带来了不少的学习门槛")]),t._v(" "),n("li",[t._v("Angular 针对大型应用而引入的设计和功能，对于大多数前端应用来说无法物尽其用，反而增加了学习成本")]),t._v(" "),n("li",[t._v("Angular 提供了一整套完整的解决方案，反而不像 Vue/React 等库灵活，可以随意搭配其他的状态管理、构建库等（其实也是可以的，可能成本和门槛会高一些），显得笨重")])]),t._v(" "),n("p",[t._v("由于以上原因，大家在选框架的时候常常讨论的是用 React 还是 Vue，虽然同样作为热门框架，Angular 似乎在无形中就被大家排除在外。使用 Angular 框架的人越少，相关的中文相关的文档和教程也会很少，大家对它的了解和认知都容易不够全面。")]),t._v(" "),n("p",[t._v("其实，很多人会问我喜欢 React 还是 Vue，我总会告诉他们我喜欢 Angular，他们也总会觉得很奇怪哈哈哈哈。实际上，AngularJS 是我最早接触的一个前端框架，我也曾经使用过断崖式升级的 Angular2，它们带给我的除了很多未知的知识和领域，还有拓宽了我对前端编程的一些认知。我想，喜欢 Angular，也可能是因为有一些缘分在内的原因叭~")]),t._v(" "),n("h2",{attrs:{id:"angular-框架解读"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#angular-框架解读"}},[t._v("#")]),t._v(" "),n("a",{attrs:{href:"http://www.godbasin.com/angular/deep-into-angular/angular-design-0-prestart.html#angular-%E6%A1%86%E6%9E%B6%E8%A7%A3%E8%AF%BB",target:"_blank",rel:"noopener noreferrer"}},[t._v("#"),n("OutboundLink")],1),t._v(" Angular 框架解读")]),t._v(" "),n("p",[t._v("源码阅读对很多人来说，都是一件挑战很大的事情，对我来说也一样。")]),t._v(" "),n("p",[t._v("虽然我有较多地阅读过 Vue 的源码（可参考"),n("a",{attrs:{href:"http://www.godbasin.com/vue-ebook/",target:"_blank",rel:"noopener noreferrer"}},[t._v("《深入理解 Vue.js 实战》 (opens new window)"),n("OutboundLink")],1),t._v("这本书），但前提是我对这个框架有足够多的理解和使用经验，在尝试介绍和解说时，也更是倾向使用者的角度来进行。而对于 React，则是因为理解和使用经验的缺乏，未曾有机会深入地去了解它，但也有阅读过写得不错的源码解读（可参考"),n("a",{attrs:{href:"https://github.com/BetaSu/just-react",target:"_blank",rel:"noopener noreferrer"}},[t._v("《React 技术揭秘》 (opens new window)"),n("OutboundLink")],1),t._v("一书）。")]),t._v(" "),n("p",[t._v("对于阅读源码来说，最好的方式便是从已知的理解和认知中开始。阅读源码，并不是为了熟悉掌握源码本身，更是为了掌握其中的一些值得借鉴的思考方式和设计，因此我也尽可能减少代码占据的篇幅，使用自己理解后的方式来进行描述。")]),t._v(" "),n("p",[t._v("那么，后面我会从自己认为最值得参考和学习的地方开始，一点点学习其中的精华。以我当前有限的认知，大概会包括以下内容：")]),t._v(" "),n("ul",[n("li",[t._v("依赖注入整体框架的设计")]),t._v(" "),n("li",[t._v("组件设计与管理")]),t._v(" "),n("li",[t._v("Provider 与 Service 的设计")]),t._v(" "),n("li",[t._v("NgModule 模块化组织（多级/分层）的设计")]),t._v(" "),n("li",[t._v("模板引擎/模板编译过程的整体设计")]),t._v(" "),n("li",[t._v("Zone 设计：提升计算速度")]),t._v(" "),n("li",[t._v("JIT/AOT 设计")]),t._v(" "),n("li",[t._v("元数据设计：（"),n("code",[t._v("Reflect.metadata")]),t._v("）的引入和使用思考")]),t._v(" "),n("li",[t._v("响应式编程：Rxjs 的引入和使用思考")])]),t._v(" "),n("p",[t._v("在时隔 3 年之后再次接触 Angular，还是直接以阅读源码的方式来进行，对我来说是个不小的挑战。但这些年来，我也一直在尝试做各种不同的新的事情，如果因为觉得困难而放弃，那么这个天花板便是我自身，而不是什么“环境所迫”、“没有时间”这样的借口。或许我会写得很慢，但我依然希望自己能一点点去细细钻研，也希望至少以上的内容能最终掌握。")]),t._v(" "),n("p",[t._v("这是一个大工程，因为我写下这篇文章来给自己预热，也希望能打打气，更是尝试立下一个 FLAG 吧。")]),t._v(" "),n("blockquote",[n("p",[t._v("备案 © 2022 Boris 个人网站 | "),n("a",{attrs:{href:"https://beian.miit.gov.cn",target:"_blank",rel:"noopener noreferrer"}},[t._v("粤 ICP 备 20061538 号"),n("OutboundLink")],1),t._v(" | 保留所有权利")])])])}),[],!1,null,null,null);a.default=r.exports}}]);